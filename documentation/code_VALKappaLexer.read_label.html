<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Graph" rel="Chapter" href="Graph.html">
<link title="Species" rel="Chapter" href="Species.html">
<link title="Node" rel="Chapter" href="Node.html">
<link title="DynamicArray" rel="Chapter" href="DynamicArray.html">
<link title="LongString" rel="Chapter" href="LongString.html">
<link title="Heap" rel="Chapter" href="Heap.html">
<link title="Mods" rel="Chapter" href="Mods.html">
<link title="MapExt" rel="Chapter" href="MapExt.html">
<link title="LiftSet" rel="Chapter" href="LiftSet.html">
<link title="Profiling" rel="Chapter" href="Profiling.html">
<link title="MemoryManagement" rel="Chapter" href="MemoryManagement.html">
<link title="SafeHeap" rel="Chapter" href="SafeHeap.html">
<link title="LargeArray" rel="Chapter" href="LargeArray.html">
<link title="Tools" rel="Chapter" href="Tools.html">
<link title="Random_tree" rel="Chapter" href="Random_tree.html">
<link title="ValMap" rel="Chapter" href="ValMap.html">
<link title="Main" rel="Chapter" href="Main.html">
<link title="Parameter" rel="Chapter" href="Parameter.html">
<link title="Cflow_handler" rel="Chapter" href="Cflow_handler.html">
<link title="Causal" rel="Chapter" href="Causal.html">
<link title="Compression_main" rel="Chapter" href="Compression_main.html">
<link title="Kappa_instantiation" rel="Chapter" href="Kappa_instantiation.html">
<link title="Blackboard_generation" rel="Chapter" href="Blackboard_generation.html">
<link title="Propagation_heuristics" rel="Chapter" href="Propagation_heuristics.html">
<link title="Generic_branch_and_cut_solver" rel="Chapter" href="Generic_branch_and_cut_solver.html">
<link title="Blackboard" rel="Chapter" href="Blackboard.html">
<link title="KappaLexer" rel="Chapter" href="KappaLexer.html">
<link title="Ast" rel="Chapter" href="Ast.html">
<link title="Eval" rel="Chapter" href="Eval.html">
<link title="KappaParser" rel="Chapter" href="KappaParser.html">
<link title="Debug" rel="Chapter" href="Debug.html">
<link title="ExceptionDefn" rel="Chapter" href="ExceptionDefn.html">
<link title="Dynamics" rel="Chapter" href="Dynamics.html">
<link title="Precondition" rel="Chapter" href="Precondition.html">
<link title="Matching" rel="Chapter" href="Matching.html">
<link title="Mixture" rel="Chapter" href="Mixture.html">
<link title="Signature" rel="Chapter" href="Signature.html">
<link title="Environment" rel="Chapter" href="Environment.html">
<link title="Plot" rel="Chapter" href="Plot.html">
<link title="External" rel="Chapter" href="External.html">
<link title="State" rel="Chapter" href="State.html">
<link title="Run" rel="Chapter" href="Run.html">
<link title="NonLocal" rel="Chapter" href="NonLocal.html"><title>KappaLexer.read_label</title>
</head>
<body>
<code class="code">let rec token lexbuf =
    __ocaml_lex_token_rec lexbuf 0
and __ocaml_lex_token_rec lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 ->
# 41 "grammar/kappaLexer.mll"
             (incr_line lexbuf ; token lexbuf)
# 550 "grammar/kappaLexer.ml"

  | 1 ->
# 42 "grammar/kappaLexer.mll"
         (let pos = position lexbuf in DO pos)
# 555 "grammar/kappaLexer.ml"

  | 2 ->
# 43 "grammar/kappaLexer.mll"
            (let pos = position lexbuf in UNTIL pos)
# 560 "grammar/kappaLexer.ml"

  | 3 ->
# 44 "grammar/kappaLexer.mll"
         (let pos = position lexbuf in SET pos)
# 565 "grammar/kappaLexer.ml"

  | 4 ->
# 45 "grammar/kappaLexer.mll"
         (let pos = position lexbuf in AND pos)
# 570 "grammar/kappaLexer.ml"

  | 5 ->
# 46 "grammar/kappaLexer.mll"
         (let pos = position lexbuf in OR pos)
# 575 "grammar/kappaLexer.ml"

  | 6 ->
# 47 "grammar/kappaLexer.mll"
           (let pos = position lexbuf in KAPPA_RAR pos)
# 580 "grammar/kappaLexer.ml"

  | 7 ->
# 48 "grammar/kappaLexer.mll"
          (let pos = position lexbuf in KAPPA_NOPOLY pos)
# 585 "grammar/kappaLexer.ml"

  | 8 ->
let
# 49 "grammar/kappaLexer.mll"
            s
# 591 "grammar/kappaLexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 49 "grammar/kappaLexer.mll"
              (let pos = position lexbuf in
									match s with  
						 			| "$DEL" -> (DELETE pos)
									| "$ADD" -> (INTRO pos)
									| "$SNAPSHOT" -> (SNAPSHOT pos) 
									| "$STOP" -> (STOP pos) 
									| s -> return_error lexbuf ("Perturbation effect \""^s^"\" is not defined")
					 			)
# 602 "grammar/kappaLexer.ml"

  | 9 ->
# 57 "grammar/kappaLexer.mll"
        (let lab = read_label "" [']'] lexbuf in 
						let pos = position lexbuf in 
							match lab with
								| "E" -> EVENT pos
								| "T" -> TIME pos
								| "log" -> LOG pos
								| "sin" -> SINUS pos
								| "cos" -> COSINUS pos
								| "tan" -> TAN pos
								| "exp" -> EXPONENT pos
								| "int" -> ABS pos
								| "mod" -> MODULO pos
								| "sqrt" -> SQRT pos
								| "inf" -> INFINITY pos
								| "true" -> TRUE pos
								| "false" -> FALSE pos
								| "not" -> NOT pos
								| "pi" -> FLOAT (3.14159265,pos)
								| "emax" -> EMAX pos
								| "tmax" -> TMAX pos
								| _ as s -> return_error lexbuf ("Symbol \""^s^"\" is not defined")
						)
# 628 "grammar/kappaLexer.ml"

  | 10 ->
# 79 "grammar/kappaLexer.mll"
         (let filename = read_label "" ['\"'] lexbuf in let pos = position lexbuf in FILENAME (filename,pos))
# 633 "grammar/kappaLexer.ml"

  | 11 ->
# 80 "grammar/kappaLexer.mll"
        (PIPE)
# 638 "grammar/kappaLexer.ml"

  | 12 ->
# 81 "grammar/kappaLexer.mll"
           (incr_line lexbuf ; NEWLINE)
# 643 "grammar/kappaLexer.ml"

  | 13 ->
# 82 "grammar/kappaLexer.mll"
         (incr_line lexbuf ; NEWLINE)
# 648 "grammar/kappaLexer.ml"

  | 14 ->
# 83 "grammar/kappaLexer.mll"
          (comment lexbuf)
# 653 "grammar/kappaLexer.ml"

  | 15 ->
let
# 84 "grammar/kappaLexer.mll"
                 n
# 659 "grammar/kappaLexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 84 "grammar/kappaLexer.mll"
                   (let pos = position lexbuf in INT(int_of_string n,pos))
# 663 "grammar/kappaLexer.ml"

  | 16 ->
let
# 85 "grammar/kappaLexer.mll"
              f
# 669 "grammar/kappaLexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 85 "grammar/kappaLexer.mll"
                (let pos = position lexbuf in FLOAT(float_of_string f,pos))
# 673 "grammar/kappaLexer.ml"

  | 17 ->
# 86 "grammar/kappaLexer.mll"
           (let lab = read_label "" ['\''] lexbuf in let pos = position lexbuf in LABEL(lab,pos))
# 678 "grammar/kappaLexer.ml"

  | 18 ->
let
# 87 "grammar/kappaLexer.mll"
            str
# 684 "grammar/kappaLexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 87 "grammar/kappaLexer.mll"
                (let pos = position lexbuf in ID(str,pos))
# 688 "grammar/kappaLexer.ml"

  | 19 ->
# 88 "grammar/kappaLexer.mll"
          (AT)
# 693 "grammar/kappaLexer.ml"

  | 20 ->
# 89 "grammar/kappaLexer.mll"
          (COMMA)
# 698 "grammar/kappaLexer.ml"

  | 21 ->
# 90 "grammar/kappaLexer.mll"
          (OP_PAR)
# 703 "grammar/kappaLexer.ml"

  | 22 ->
# 91 "grammar/kappaLexer.mll"
          (CL_PAR)
# 708 "grammar/kappaLexer.ml"

  | 23 ->
# 92 "grammar/kappaLexer.mll"
        (DOT)
# 713 "grammar/kappaLexer.ml"

  | 24 ->
# 93 "grammar/kappaLexer.mll"
        (let pos = position lexbuf in PLUS pos)
# 718 "grammar/kappaLexer.ml"

  | 25 ->
# 94 "grammar/kappaLexer.mll"
        (let pos = position lexbuf in MULT pos)
# 723 "grammar/kappaLexer.ml"

  | 26 ->
# 95 "grammar/kappaLexer.mll"
        (let pos = position lexbuf in MINUS pos)
# 728 "grammar/kappaLexer.ml"

  | 27 ->
# 96 "grammar/kappaLexer.mll"
        (let pos = position lexbuf in POW pos)
# 733 "grammar/kappaLexer.ml"

  | 28 ->
# 97 "grammar/kappaLexer.mll"
        (let pos = position lexbuf in DIV pos)
# 738 "grammar/kappaLexer.ml"

  | 29 ->
# 98 "grammar/kappaLexer.mll"
        (let pos = position lexbuf in SMALLER pos)
# 743 "grammar/kappaLexer.ml"

  | 30 ->
# 99 "grammar/kappaLexer.mll"
        (let pos = position lexbuf in GREATER pos)
# 748 "grammar/kappaLexer.ml"

  | 31 ->
# 100 "grammar/kappaLexer.mll"
        (let pos = position lexbuf in EQUAL pos)
# 753 "grammar/kappaLexer.ml"

  | 32 ->
# 101 "grammar/kappaLexer.mll"
        (let lab = read_label "" [':'] lexbuf in 
						let pos = position lexbuf in 
							match lab with
								| "agent" -> (SIGNATURE pos)
								| "init" -> (INIT pos)
								| "var" -> (LET pos)
								| "plot" -> (PLOT pos)
								| "mod" -> (PERT pos)
								| "ref" -> (REF pos)
								| "obs" -> (OBS pos)
								| _ as s -> return_error lexbuf ("Instruction \""^s^"\" not recognized")
					 )
# 769 "grammar/kappaLexer.ml"

  | 33 ->
let
# 113 "grammar/kappaLexer.mll"
                  s
# 775 "grammar/kappaLexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 113 "grammar/kappaLexer.mll"
                    ( let i = String.index s '{' in 
													let j = String.index s '}' in 
														let r = String.sub s (i+1) (j-i-1) in 
															try DOT_RADIUS (int_of_string r) with 
																| Failure _ -> return_error lexbuf (Printf.sprintf "Invalid radius")
										   )
# 784 "grammar/kappaLexer.ml"

  | 34 ->
let
# 119 "grammar/kappaLexer.mll"
                   s
# 790 "grammar/kappaLexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 119 "grammar/kappaLexer.mll"
                     (let i = String.index s '{' in 
													let j = String.index s '}' in 
														let r = String.sub s (i+1) (j-i-1) in 
															try PLUS_RADIUS (int_of_string r) with 
																| Failure _ -> return_error lexbuf (Printf.sprintf "Invalid radius")
										   )
# 799 "grammar/kappaLexer.ml"

  | 35 ->
# 125 "grammar/kappaLexer.mll"
          (KAPPA_LNK)
# 804 "grammar/kappaLexer.ml"

  | 36 ->
let
# 126 "grammar/kappaLexer.mll"
                        s
# 810 "grammar/kappaLexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 126 "grammar/kappaLexer.mll"
                          (let i = String.index s '~' in 
			                     	 let r = String.sub s (i+1) (String.length s-i-1) in
																let pos = position lexbuf in 
																	KAPPA_MRK (r,pos)
													 )
# 818 "grammar/kappaLexer.ml"

  | 37 ->
# 131 "grammar/kappaLexer.mll"
          (let pos = position lexbuf in (KAPPA_WLD pos))
# 823 "grammar/kappaLexer.ml"

  | 38 ->
# 132 "grammar/kappaLexer.mll"
          (let pos = position lexbuf in (KAPPA_SEMI pos))
# 828 "grammar/kappaLexer.ml"

  | 39 ->
# 133 "grammar/kappaLexer.mll"
             (token lexbuf)
# 833 "grammar/kappaLexer.ml"

  | 40 ->
# 134 "grammar/kappaLexer.mll"
          (reach_eof lexbuf; EOF)
# 838 "grammar/kappaLexer.ml"

  | 41 ->
let
# 135 "grammar/kappaLexer.mll"
           c
# 844 "grammar/kappaLexer.ml"
= Lexing.sub_lexeme_char lexbuf lexbuf.Lexing.lex_start_pos in
# 135 "grammar/kappaLexer.mll"
             (return_error lexbuf (Printf.sprintf "invalid use of character %c" c))
# 848 "grammar/kappaLexer.ml"

  | __ocaml_lex_state -> lexbuf.Lexing.refill_buff lexbuf; __ocaml_lex_token_rec lexbuf __ocaml_lex_state

and read_label acc char_list lexbuf =
    __ocaml_lex_read_label_rec acc char_list lexbuf 67
and __ocaml_lex_read_label_rec acc char_list lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 ->
# 138 "grammar/kappaLexer.mll"
          (acc)
# 859 "grammar/kappaLexer.ml"

  | 1 ->
# 139 "grammar/kappaLexer.mll"
             (incr_line lexbuf ; read_label acc char_list lexbuf)
# 864 "grammar/kappaLexer.ml"

  | 2 ->
let
# 140 "grammar/kappaLexer.mll"
           c
# 870 "grammar/kappaLexer.ml"
= Lexing.sub_lexeme_char lexbuf lexbuf.Lexing.lex_start_pos in
# 140 "grammar/kappaLexer.mll"
             (if List.mem c char_list then acc else read_label (Printf.sprintf "%s%c" acc c) char_list lexbuf)
# 874 "grammar/kappaLexer.ml"

  | __ocaml_lex_state -> lexbuf.Lexing.refill_buff lexbuf; __ocaml_lex_read_label_rec acc char_list lexbuf __ocaml_lex_state

and comment lexbuf =
    __ocaml_lex_comment_rec lexbuf 72
and __ocaml_lex_comment_rec lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 ->
# 143 "grammar/kappaLexer.mll"
           (incr_line lexbuf ; NEWLINE)
# 885 "grammar/kappaLexer.ml"

  | 1 ->
# 144 "grammar/kappaLexer.mll"
             (incr_line lexbuf ; comment lexbuf)
# 890 "grammar/kappaLexer.ml"

  | 2 ->
# 145 "grammar/kappaLexer.mll"
          (EOF)
# 895 "grammar/kappaLexer.ml"

  | 3 ->
# 146 "grammar/kappaLexer.mll"
        (comment lexbuf)
# 900 "grammar/kappaLexer.ml"

  | __ocaml_lex_state -> lexbuf.Lexing.refill_buff lexbuf; __ocaml_lex_comment_rec lexbuf __ocaml_lex_state</code></body></html>